
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Advanced Configuration &#8212; Talk 4.x.x documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Asset Management" href="integrating/asset-management.html" />
    <link rel="prev" title="Required Configuration" href="02-01-required-configuration.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="advanced-configuration">
<span id="advanced-configuration"></span><h1>Advanced Configuration<a class="headerlink" href="#advanced-configuration" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference external" href="#talk-cache-expiry-comment-count">TALK_CACHE_EXPIRY_COMMENT_COUNT</a></li>
<li><a class="reference external" href="#talk-default-lang">TALK_DEFAULT_LANG</a></li>
<li><a class="reference external" href="#talk-whitelisted-languages">TALK_WHITELISTED_LANGUAGES</a></li>
<li><a class="reference external" href="#talk-default-stream-tab">TALK_DEFAULT_STREAM_TAB</a></li>
<li><a class="reference external" href="#talk-disable-autoflag-suspect-words">TALK_DISABLE_AUTOFLAG_SUSPECT_WORDS</a></li>
<li><a class="reference external" href="#talk-disable-embed-polyfill">TALK_DISABLE_EMBED_POLYFILL</a></li>
<li><a class="reference external" href="#talk-disable-static-server">TALK_DISABLE_STATIC_SERVER</a></li>
<li><a class="reference external" href="#talk-helmet-configuration">TALK_HELMET_CONFIGURATION</a></li>
<li><a class="reference external" href="#talk-install-lock">TALK_INSTALL_LOCK</a></li>
<li><a class="reference external" href="#talk-jwt-alg">TALK_JWT_ALG</a></li>
<li><a class="reference external" href="#talk-jwt-audience">TALK_JWT_AUDIENCE</a></li>
<li><a class="reference external" href="#talk-jwt-clear-cookie-logout">TALK_JWT_CLEAR_COOKIE_LOGOUT</a></li>
<li><a class="reference external" href="#talk-jwt-cookie-name">TALK_JWT_COOKIE_NAME</a></li>
<li><a class="reference external" href="#talk-jwt-cookie-names">TALK_JWT_COOKIE_NAMES</a></li>
<li><a class="reference external" href="#talk-jwt-disable-audience">TALK_JWT_DISABLE_AUDIENCE</a></li>
<li><a class="reference external" href="#talk-jwt-disable-issuer">TALK_JWT_DISABLE_ISSUER</a></li>
<li><a class="reference external" href="#talk-jwt-expiry">TALK_JWT_EXPIRY</a></li>
<li><a class="reference external" href="#talk-jwt-issuer">TALK_JWT_ISSUER</a></li>
<li><a class="reference external" href="#talk-jwt-secret">TALK_JWT_SECRET</a></li>
<li><a class="reference external" href="#talk-jwt-secrets">TALK_JWT_SECRETS</a></li>
<li><a class="reference external" href="#talk-jwt-signing-cookie-name">TALK_JWT_SIGNING_COOKIE_NAME</a></li>
<li><a class="reference external" href="#talk-jwt-user-id-claim">TALK_JWT_USER_ID_CLAIM</a></li>
<li><a class="reference external" href="#talk-keep-alive">TALK_KEEP_ALIVE</a></li>
<li><a class="reference external" href="#talk-recaptcha-public">TALK_RECAPTCHA_PUBLIC</a></li>
<li><a class="reference external" href="#talk-recaptcha-secret">TALK_RECAPTCHA_SECRET</a></li>
<li><a class="reference external" href="#talk-recaptcha-window">TALK_RECAPTCHA_WINDOW</a></li>
<li><a class="reference external" href="#talk-recaptcha-incorrect-trigger">TALK_RECAPTCHA_INCORRECT_TRIGGER</a></li>
<li><a class="reference external" href="#talk-redis-client-configuration">TALK_REDIS_CLIENT_CONFIGURATION</a></li>
<li><a class="reference external" href="#talk-redis-cluster-configuration">TALK_REDIS_CLUSTER_CONFIGURATION</a></li>
<li><a class="reference external" href="#talk-redis-cluster-mode">TALK_REDIS_CLUSTER_MODE</a></li>
<li><a class="reference external" href="#talk-redis-reconnection-backoff-factor">TALK_REDIS_RECONNECTION_BACKOFF_FACTOR</a></li>
<li><a class="reference external" href="#talk-redis-reconnection-backoff-minimum-time">TALK_REDIS_RECONNECTION_BACKOFF_MINIMUM_TIME</a></li>
<li><a class="reference external" href="#talk-root-url-mount-path">TALK_ROOT_URL_MOUNT_PATH</a></li>
<li><a class="reference external" href="#talk-smtp-from-address">TALK_SMTP_FROM_ADDRESS</a></li>
<li><a class="reference external" href="#talk-smtp-host">TALK_SMTP_HOST</a></li>
<li><a class="reference external" href="#talk-smtp-password">TALK_SMTP_PASSWORD</a></li>
<li><a class="reference external" href="#talk-smtp-port">TALK_SMTP_PORT</a></li>
<li><a class="reference external" href="#talk-smtp-username">TALK_SMTP_USERNAME</a></li>
<li><a class="reference external" href="#talk-static-uri">TALK_STATIC_URI</a></li>
<li><a class="reference external" href="#talk-threading-level">TALK_THREADING_LEVEL</a></li>
<li><a class="reference external" href="#talk-websocket-live-uri">TALK_WEBSOCKET_LIVE_URI</a></li>
<li><a class="reference external" href="#trust-thresholds">TRUST_THRESHOLDS</a></li>
<li><a class="reference external" href="#talk-disable-ignore-flags-against-staff">TALK_DISABLE_IGNORE_FLAGS_AGAINST_STAFF</a></li>
<li><a class="reference external" href="#talk-email-subject-prefix">TALK_EMAIL_SUBJECT_PREFIX</a></li>
<li><a class="reference external" href="#disable-create-mongo-indexes">DISABLE_CREATE_MONGO_INDEXES</a></li>
<li><a class="reference external" href="#talk-settings-cache-time">TALK_SETTINGS_CACHE_TIME</a></li>
<li><a class="reference external" href="#apollo-engine-key">APOLLO_ENGINE_KEY</a></li>
<li><a class="reference external" href="#allow-no-limit-queries">ALLOW_NO_LIMIT_QUERIES</a></li>
<li><a class="reference external" href="#talk-addtl-comments-on-load-more">TALK_ADDTL_COMMENTS_ON_LOAD_MORE</a></li>
<li><a class="reference external" href="#talk-asset-comments-load-depth">TALK_ASSET_COMMENTS_LOAD_DEPTH</a></li>
<li><a class="reference external" href="#talk-reply-comments-load-depth">TALK_REPLY_COMMENTS_LOAD_DEPTH</a></li>
<li><a class="reference external" href="#talk-logging-level">TALK_LOGGING_LEVEL</a></li>
<li><a class="reference external" href="#talk-scraper-headers">TALK_SCRAPER_HEADERS</a></li>
<li><a class="reference external" href="#talk-scraper-proxy-url">TALK_SCRAPER_PROXY_URL</a></li>
</ul>
<p>Talk requires configuration in order to customize the installation. The default
behavior is to load its configuration from the environment, following the
<a class="reference external" href="https://12factor.net/">12 Factor App Manifesto</a>.
In development, you can specify configuration in a file named <code class="docutils literal notranslate"><span class="pre">.env</span></code> and it will
be loaded into the environment when you run <code class="docutils literal notranslate"><span class="pre">yarn</span> <span class="pre">watch:server</span></code>.</p>
<p>The variables above have defaults, and are <em>optional</em> to start your
instance of Talk.</p>
<p>If this is your first time configuring Talk, ensure you’ve also added the
<a class="reference external" href="./02-01-required-configuration.html">Required Configuration</a> as well,
otherwise the application will fail to start.</p>
<div class="section" id="talk-cache-expiry-comment-count">
<span id="talk-cache-expiry-comment-count"></span><h2>TALK_CACHE_EXPIRY_COMMENT_COUNT<a class="headerlink" href="#talk-cache-expiry-comment-count" title="Permalink to this headline">¶</a></h2>
<p>Configure the duration for which comment counts are cached for, parsed by
<a class="reference external" href="https://www.npmjs.com/package/ms">ms</a>. (Default <code class="docutils literal notranslate"><span class="pre">1hr</span></code>)</p>
</div>
<div class="section" id="talk-default-lang">
<span id="talk-default-lang"></span><h2>TALK_DEFAULT_LANG<a class="headerlink" href="#talk-default-lang" title="Permalink to this headline">¶</a></h2>
<p>This is a <strong>Build Variable</strong> and must be consumed during build. If using the
<a class="reference external" href="./01-01-talk-quickstart.html#onbuild">Docker-onbuild</a>
image you can specify it with <code class="docutils literal notranslate"><span class="pre">--build-arg</span> <span class="pre">TALK_DEFAULT_LANG=en</span></code>.</p>
<p>Specify the default translation language. (Default <code class="docutils literal notranslate"><span class="pre">en</span></code>)</p>
</div>
<div class="section" id="talk-whitelisted-languages">
<span id="talk-whitelisted-languages"></span><h2>TALK_WHITELISTED_LANGUAGES<a class="headerlink" href="#talk-whitelisted-languages" title="Permalink to this headline">¶</a></h2>
<p>This is a <strong>Build Variable</strong> and must be consumed during build. If using the
<a class="reference external" href="./01-01-talk-quickstart.html#onbuild">Docker-onbuild</a>
image you can specify it with <code class="docutils literal notranslate"><span class="pre">--build-arg</span> <span class="pre">TALK_WHITELISTED_LANGUAGES=en</span></code>.</p>
<p>Specify the comma separated whitelisted languages that you want the Talk
application to serve. This will override the available set of languages that
Talk will allow to be served.</p>
<p>If the <a class="reference external" href="#talk-default-lang">TALK_DEFAULT_LANG</a> is not included in this list of
whitelisted languages, then the first whitelisted language will become the
default language. If this parameter is empty, then all languages supported by
Talk will be whitelisted. (Default ‘’)</p>
</div>
<div class="section" id="talk-default-stream-tab">
<span id="talk-default-stream-tab"></span><h2>TALK_DEFAULT_STREAM_TAB<a class="headerlink" href="#talk-default-stream-tab" title="Permalink to this headline">¶</a></h2>
<p>This is a <strong>Build Variable</strong> and must be consumed during build. If using the
<a class="reference external" href="./01-01-talk-quickstart.html#onbuild">Docker-onbuild</a>
image you can specify it with <code class="docutils literal notranslate"><span class="pre">--build-arg</span> <span class="pre">TALK_DEFAULT_STREAM_TAB=all</span></code>.</p>
<p>Specify the default stream tab in the admin. (Default <code class="docutils literal notranslate"><span class="pre">all</span></code>)</p>
</div>
<div class="section" id="talk-disable-autoflag-suspect-words">
<span id="talk-disable-autoflag-suspect-words"></span><h2>TALK_DISABLE_AUTOFLAG_SUSPECT_WORDS<a class="headerlink" href="#talk-disable-autoflag-suspect-words" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, disables flagging of comments that match the suspect word filter. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
</div>
<div class="section" id="talk-disable-embed-polyfill">
<span id="talk-disable-embed-polyfill"></span><h2>TALK_DISABLE_EMBED_POLYFILL<a class="headerlink" href="#talk-disable-embed-polyfill" title="Permalink to this headline">¶</a></h2>
<p>This is a <strong>Build Variable</strong> and must be consumed during build. If using the
<a class="reference external" href="./01-01-talk-quickstart.html#onbuild">Docker-onbuild</a>
image you can specify it with <code class="docutils literal notranslate"><span class="pre">--build-arg</span> <span class="pre">TALK_DISABLE_EMBED_POLYFILL=TRUE</span></code>.</p>
<p>When set to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, the build process will not include the
<a class="reference external" href="https://babeljs.io/docs/usage/polyfill/">babel-polyfill</a>
in the embed.js target that is loaded on the page that loads the embed. (Default
<code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
</div>
<div class="section" id="talk-disable-static-server">
<span id="talk-disable-static-server"></span><h2>TALK_DISABLE_STATIC_SERVER<a class="headerlink" href="#talk-disable-static-server" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, it will not mount the static asset serving routes on the router.
This is used primarily in conjunction with <a class="reference external" href="#talk-static-uri">TALK_STATIC_URI</a>
when the static assets are being hosted on an external domain. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
</div>
<div class="section" id="talk-helmet-configuration">
<span id="talk-helmet-configuration"></span><h2>TALK_HELMET_CONFIGURATION<a class="headerlink" href="#talk-helmet-configuration" title="Permalink to this headline">¶</a></h2>
<p>A JSON string representing the configuration passed to the
<a class="reference external" href="https://github.com/helmetjs/helmet">helmet</a> middleware. It
can be used to disable features like <a class="reference external" href="https://helmetjs.github.io/docs/hsts/">HSTS</a>
and others by simply providing the configuration as detailed on the
<a class="reference external" href="https://helmetjs.github.io/docs/">helmet docs</a>. (Default <code class="docutils literal notranslate"><span class="pre">{}</span></code>)</p>
<p>For sites that do not have SSL enabled on all their pages across their domain,
it is critical that you specify the following to disable the
<a class="reference external" href="https://helmetjs.github.io/docs/hsts/">HSTS</a> headers from
being sent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TALK_HELMET_CONFIGURATION</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hsts&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">}</span>
</pre></div>
</div>
<p>To disable these headers from being sent.</p>
</div>
<div class="section" id="talk-install-lock">
<span id="talk-install-lock"></span><h2>TALK_INSTALL_LOCK<a class="headerlink" href="#talk-install-lock" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, disables the dynamic setup endpoint <code class="docutils literal notranslate"><span class="pre">/admin/install</span></code> from even
loading. This prevents hits to the database with enabled. This should always be
set to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> after you’ve deployed Talk. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
</div>
<div class="section" id="talk-jwt-alg">
<span id="talk-jwt-alg"></span><h2>TALK_JWT_ALG<a class="headerlink" href="#talk-jwt-alg" title="Permalink to this headline">¶</a></h2>
<p>The algorithm used to sign/verify JWTs used for session management. Read up
about alternative algorithms on the
<a class="reference external" href="https://www.npmjs.com/package/jsonwebtoken#algorithms-supported">jsonwebtoken</a>
package. (Default <code class="docutils literal notranslate"><span class="pre">HS256</span></code>)</p>
<div class="section" id="shared-secret">
<span id="shared-secret"></span><h3>Shared Secret<a class="headerlink" href="#shared-secret" title="Permalink to this headline">¶</a></h3>
<p>You would use a shared secret when you have no need to share the tokens with
other applications in your organization.</p>
<p>Supported signing algorithms:</p>
<ul class="simple">
<li>HS256</li>
<li>HS384</li>
<li>HS512</li>
</ul>
<p>These must be provided in the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;secret&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;my secret key&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="asymmetric-secret">
<span id="asymmetric-secret"></span><h3>Asymmetric Secret<a class="headerlink" href="#asymmetric-secret" title="Permalink to this headline">¶</a></h3>
<p>You would use a asymmetric secret when you want to share the token in your
organization, and would like to pass an existing auth token to Talk in order to
authenticate your users.</p>
<p>Supported signing algorithms:</p>
<ul class="simple">
<li>RS256</li>
<li>RS384</li>
<li>RS512</li>
<li>ES256</li>
<li>ES384</li>
<li>ES512</li>
</ul>
<p>These must be provided in the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;public&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;the PEM encoded public key&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;the PEM encoded private key&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that when using the asymmetric keys as discussed above, the certificates
must have their newlines replaced with <code class="docutils literal notranslate"><span class="pre">\\n</span></code>, this is to ensure that the
newlines are preserved after JSON decoding. Not doing so will result in parsing
errors.</p>
<p>To assist with this process, we have developed a tool that can generate new
certificates that match our required format: <a class="reference external" href="https://github.com/coralproject/coralcert">coralcert</a>.
This tool can generate RSA and ECDSA certificates, check it’s <a class="reference external" href="https://github.com/coralproject/coralcert">README</a>
for more details.</p>
</div>
</div>
<div class="section" id="talk-jwt-audience">
<span id="talk-jwt-audience"></span><h2>TALK_JWT_AUDIENCE<a class="headerlink" href="#talk-jwt-audience" title="Permalink to this headline">¶</a></h2>
<p>The audience <a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.3">aud</a>
claim for login JWT tokens. (Default <code class="docutils literal notranslate"><span class="pre">talk</span></code>)</p>
</div>
<div class="section" id="talk-jwt-clear-cookie-logout">
<span id="talk-jwt-clear-cookie-logout"></span><h2>TALK_JWT_CLEAR_COOKIE_LOGOUT<a class="headerlink" href="#talk-jwt-clear-cookie-logout" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>, Talk will not clear the cookie with name
<a class="reference external" href="#talk-jwt-signing-cookie-name">TALK_JWT_SIGNING_COOKIE_NAME</a> when logging out
but will still blacklist the token. (Default <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>)</p>
</div>
<div class="section" id="talk-jwt-cookie-name">
<span id="talk-jwt-cookie-name"></span><h2>TALK_JWT_COOKIE_NAME<a class="headerlink" href="#talk-jwt-cookie-name" title="Permalink to this headline">¶</a></h2>
<p>The default cookie name to check for a valid JWT token to use for verifying a
user. (Default <code class="docutils literal notranslate"><span class="pre">authorization</span></code>)</p>
</div>
<div class="section" id="talk-jwt-cookie-names">
<span id="talk-jwt-cookie-names"></span><h2>TALK_JWT_COOKIE_NAMES<a class="headerlink" href="#talk-jwt-cookie-names" title="Permalink to this headline">¶</a></h2>
<p>The different cookie names to check for a JWT token in, separated by a <code class="docutils literal notranslate"><span class="pre">,</span></code>. By
default, we always use the value of <a class="reference external" href="#talk-jwt-cookie-name">TALK_JWT_COOKIE_NAME</a>
and <a class="reference external" href="#talk-jwt-signing-cookie-name">TALK_JWT_SIGNING_COOKIE_NAME</a> for this
value. Any additional cookie names specified here will be appended to the list
of cookie names to inspect.</p>
<p>For example, the value of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TALK_JWT_COOKIE_NAME</span><span class="o">=</span><span class="n">talk</span>
<span class="n">TALK_JWT_SIGNING_COOKIE_NAME</span><span class="o">=</span><span class="n">talk</span>
<span class="n">TALK_JWT_COOKIE_NAMES</span><span class="o">=</span><span class="n">coralproject</span><span class="o">.</span><span class="n">talk</span><span class="p">,</span><span class="n">coralproject</span><span class="o">.</span><span class="n">auth</span>
</pre></div>
</div>
<p>Would mean we would check the following cookies (in order) for a valid token:</p>
<ol class="simple">
<li><code class="docutils literal notranslate"><span class="pre">talk</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">coralproject.talk</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">coralproject.auth</span></code></li>
</ol>
</div>
<div class="section" id="talk-jwt-disable-audience">
<span id="talk-jwt-disable-audience"></span><h2>TALK_JWT_DISABLE_AUDIENCE<a class="headerlink" href="#talk-jwt-disable-audience" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, Talk will not verify or sign JWT’s with an audience
<a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.3">aud</a>
claim, even if <a class="reference external" href="#talk-jwt-audience">TALK_JWT_AUDIENCE</a> is set. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
</div>
<div class="section" id="talk-jwt-disable-issuer">
<span id="talk-jwt-disable-issuer"></span><h2>TALK_JWT_DISABLE_ISSUER<a class="headerlink" href="#talk-jwt-disable-issuer" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, Talk will not verify or sign JWT’s with an issuer
<a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.1">iss</a>
claim, even if <a class="reference external" href="#talk-jwt-issuer">TALK_JWT_ISSUER</a> is set. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
</div>
<div class="section" id="talk-jwt-expiry">
<span id="talk-jwt-expiry"></span><h2>TALK_JWT_EXPIRY<a class="headerlink" href="#talk-jwt-expiry" title="Permalink to this headline">¶</a></h2>
<p>The expiry duration <a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.4">exp</a>
for the tokens issued for logged in sessions, parsed by
<a class="reference external" href="https://www.npmjs.com/package/ms">ms</a>. (Default <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">day</span></code>)</p>
<p>If the user logs out, then an entry is created in the token blacklist of it’s
<a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.7">jti</a> for
set to be automatically removed at it’s expiry time. It is important for this
reason to create reasonable expiry lengths as to minimize the storage overhead.</p>
</div>
<div class="section" id="talk-jwt-issuer">
<span id="talk-jwt-issuer"></span><h2>TALK_JWT_ISSUER<a class="headerlink" href="#talk-jwt-issuer" title="Permalink to this headline">¶</a></h2>
<p>The issuer <a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.1">iss</a>
claim for login JWT tokens. (Defaults to value of <a class="reference external" href="./02-01-required-configuration.html#talk-root-url">TALK_ROOT_URL</a>)</p>
</div>
<div class="section" id="talk-jwt-secret">
<span id="talk-jwt-secret"></span><h2>TALK_JWT_SECRET<a class="headerlink" href="#talk-jwt-secret" title="Permalink to this headline">¶</a></h2>
<p>Used to specify the application signing secret. You can specify this using a
simple string, we recommend using a password generator and pasting it’s output.
An example for <code class="docutils literal notranslate"><span class="pre">TALK_JWT_SECRET</span></code> could be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>TALK_JWT_SECRET=jX9y8G2ApcVLwyL{$6s3
</pre></div>
</div>
<p>You can also express this secret in the JSON syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TALK_JWT_SECRET</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;secret&quot;</span><span class="p">:</span> <span class="s2">&quot;jX9y8G2ApcVLwyL{$6s3&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Refer to the documentation for <a class="reference external" href="#talk-jwt-alg">TALK_JWT_ALG</a> for other signing
methods and other forms of the <code class="docutils literal notranslate"><span class="pre">TALK_JWT_SECRET</span></code>. If you are interested in using
multiple keys, then refer to <a class="reference external" href="#talk-jwt-secrets">TALK_JWT_SECRETS</a>.</p>
</div>
<div class="section" id="talk-jwt-secrets">
<span id="talk-jwt-secrets"></span><h2>TALK_JWT_SECRETS<a class="headerlink" href="#talk-jwt-secrets" title="Permalink to this headline">¶</a></h2>
<p>Used when specifying multiple secrets used for key rotations. This is a JSON
encoded array, where each element matches the JWT Secret pattern. When this is
used, you do not need to specify a <a class="reference external" href="#talk-jwt-secret">TALK_JWT_SECRET</a> as this
will take precedence. <strong>The first secret in <code class="docutils literal notranslate"><span class="pre">TALK_JWT_SECRETS</span></code> will be used for
signing, and must contain a private key if used with an asymmetric algorithm.</strong></p>
<p>All secrets should specify a <code class="docutils literal notranslate"><span class="pre">kid</span></code> field which uniquely identifies a given key
and will sign all tokens with that <code class="docutils literal notranslate"><span class="pre">kid</span></code> for later identification. <em>If a token
is not signed with the <code class="docutils literal notranslate"><span class="pre">kid</span></code> field in the header, and multiple secrets are used,
the token will fail to be verified. This field must match what’s provided to
Talk in the form of the <code class="docutils literal notranslate"><span class="pre">kid</span></code> field in the secret.</em></p>
<p>When the value of <a class="reference external" href="#talk-jwt-alg">TALK_JWT_ALG</a> is a <code class="docutils literal notranslate"><span class="pre">HS*</span></code> value, then the value
of the <code class="docutils literal notranslate"><span class="pre">TALK_JWT_SECRETS</span></code> should take the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TALK_JWT_SECRETS</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;secret&quot;</span><span class="p">:</span> <span class="s2">&quot;my-super-secret&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;secret&quot;</span><span class="p">:</span> <span class="s2">&quot;my-other-super-secret&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p>Note that the secret is stored in a JSON object, keyed by <code class="docutils literal notranslate"><span class="pre">secret</span></code>. This is only
needed when specifying in the multiple secrets for <code class="docutils literal notranslate"><span class="pre">TALK_JWT_SECRETS</span></code>, but may
be used to specify the single <a class="reference external" href="#talk-jwt-secret">TALK_JWT_SECRET</a>.</p>
<p>When the value of <a class="reference external" href="#talk-jwt-alg">TALK_JWT_ALG</a> is <strong>not</strong> a <code class="docutils literal notranslate"><span class="pre">HS*</span></code> value, then
the value of the <code class="docutils literal notranslate"><span class="pre">TALK_JWT_SECRETS</span></code> should take the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TALK_JWT_SECRETS</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;my private key&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;public&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;my public key&gt;&quot;</span><span class="p">},</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Refer to the documentation on the <a class="reference external" href="#talk-jwt-alg">TALK_JWT_ALG</a> for more
information on what to store in these parameters.</p>
</div>
<div class="section" id="talk-jwt-signing-cookie-name">
<span id="talk-jwt-signing-cookie-name"></span><h2>TALK_JWT_SIGNING_COOKIE_NAME<a class="headerlink" href="#talk-jwt-signing-cookie-name" title="Permalink to this headline">¶</a></h2>
<p>The default cookie name that is use to set a cookie containing a JWT that was
issued by Talk. (Defaults to value of <a class="reference external" href="#talk-jwt-cookie-name">TALK_JWT_COOKIE_NAME</a>)</p>
</div>
<div class="section" id="talk-jwt-user-id-claim">
<span id="talk-jwt-user-id-claim"></span><h2>TALK_JWT_USER_ID_CLAIM<a class="headerlink" href="#talk-jwt-user-id-claim" title="Permalink to this headline">¶</a></h2>
<p>Specify the claim using dot notation for where the user id should be stored/read
to/from. (Default <code class="docutils literal notranslate"><span class="pre">sub</span></code>)</p>
<p>If for example, the JWT’s claims looks something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then we would set <code class="docutils literal notranslate"><span class="pre">TALK_JWT_USER_ID_CLAIM</span></code> to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TALK_JWT_USER_ID_CLAIM</span><span class="o">=</span><span class="n">user</span><span class="o">.</span><span class="n">id</span>
</pre></div>
</div>
</div>
<div class="section" id="talk-keep-alive">
<span id="talk-keep-alive"></span><h2>TALK_KEEP_ALIVE<a class="headerlink" href="#talk-keep-alive" title="Permalink to this headline">¶</a></h2>
<p>The keepalive timeout that should be used to send keep alive messages through
the websocket to keep the socket alive, parsed by
<a class="reference external" href="https://www.npmjs.com/package/ms">ms</a>. (Default <code class="docutils literal notranslate"><span class="pre">30s</span></code>)</p>
</div>
<div class="section" id="talk-recaptcha-public">
<span id="talk-recaptcha-public"></span><h2>TALK_RECAPTCHA_PUBLIC<a class="headerlink" href="#talk-recaptcha-public" title="Permalink to this headline">¶</a></h2>
<p>Setting a reCAPTCHA Public and Secret key will enable and require reCAPTCHA upon multiple failed login attempts.</p>
<p>Client secret used for enabling reCAPTCHA powered logins. If
<a class="reference external" href="#talk-recaptcha-secret">TALK_RECAPTCHA_SECRET</a> and
<a class="reference external" href="#talk-recaptcha-public">TALK_RECAPTCHA_PUBLIC</a> are not provided it will instead
default to providing only a time based lockout. Refer to
<a class="reference external" href="https://www.google.com/recaptcha/intro/index.html">reCAPTCHA</a> for information
on getting an account setup.</p>
</div>
<div class="section" id="talk-recaptcha-secret">
<span id="talk-recaptcha-secret"></span><h2>TALK_RECAPTCHA_SECRET<a class="headerlink" href="#talk-recaptcha-secret" title="Permalink to this headline">¶</a></h2>
<p>Server secret used for enabling reCAPTCHA powered logins. If
<a class="reference external" href="#talk-recaptcha-secret">TALK_RECAPTCHA_SECRET</a> and
<a class="reference external" href="#talk-recaptcha-public">TALK_RECAPTCHA_PUBLIC</a> are not provided it will instead
default to providing only a time based lockout. Refer to
<a class="reference external" href="https://www.google.com/recaptcha/intro/index.html">reCAPTCHA</a> for information
on getting an account setup.</p>
</div>
<div class="section" id="talk-recaptcha-window">
<span id="talk-recaptcha-window"></span><h2>TALK_RECAPTCHA_WINDOW<a class="headerlink" href="#talk-recaptcha-window" title="Permalink to this headline">¶</a></h2>
<p>The rate limit time interval that there can be <a class="reference external" href="#talk_recaptcha_incorrect_trigger">TALK_RECAPTCHA_INCORRECT_TRIGGER</a> incorrect attempts until the reCAPTCHA is
marked as required, parsed by
<a class="reference external" href="https://www.npmjs.com/package/ms">ms</a>. (Default <code class="docutils literal notranslate"><span class="pre">10m</span></code>)</p>
</div>
<div class="section" id="talk-recaptcha-incorrect-trigger">
<span id="talk-recaptcha-incorrect-trigger"></span><h2>TALK_RECAPTCHA_INCORRECT_TRIGGER<a class="headerlink" href="#talk-recaptcha-incorrect-trigger" title="Permalink to this headline">¶</a></h2>
<p>The number of times that an incorrect login can be entered before within a time
perioud indicated by <a class="reference external" href="#talk_recaptcha_window">TALK_RECAPTCHA_WINDOW</a> until the
reCAPTCHA is marked as required. (Default <code class="docutils literal notranslate"><span class="pre">5</span></code>)</p>
</div>
<div class="section" id="talk-redis-client-configuration">
<span id="talk-redis-client-configuration"></span><h2>TALK_REDIS_CLIENT_CONFIGURATION<a class="headerlink" href="#talk-redis-client-configuration" title="Permalink to this headline">¶</a></h2>
<p>Configuration overrides for the redis client configuration in a JSON encoded
string. Configuration is overridden as the second parameter to the redis client
constructor, and is merged with default configuration. Refer to the
<a class="reference external" href="https://github.com/luin/ioredis">ioredis</a> docs on the
available options. (Default <code class="docutils literal notranslate"><span class="pre">{}</span></code>)</p>
</div>
<div class="section" id="talk-redis-cluster-configuration">
<span id="talk-redis-cluster-configuration"></span><h2>TALK_REDIS_CLUSTER_CONFIGURATION<a class="headerlink" href="#talk-redis-cluster-configuration" title="Permalink to this headline">¶</a></h2>
<p>The JSON encoded form of the cluster nodes. Only required when
<a class="reference external" href="#talk_redis_cluster_mode">TALK_REDIS_CLUSTER_MODE</a> is <code class="docutils literal notranslate"><span class="pre">CLUSTER</span></code>. See
<a class="reference external" href="https://github.com/luin/ioredis#cluster">https://github.com/luin/ioredis#cluster</a>
for configuration details. (Default <code class="docutils literal notranslate"><span class="pre">[]</span></code>)</p>
</div>
<div class="section" id="talk-redis-cluster-mode">
<span id="talk-redis-cluster-mode"></span><h2>TALK_REDIS_CLUSTER_MODE<a class="headerlink" href="#talk-redis-cluster-mode" title="Permalink to this headline">¶</a></h2>
<p>The cluster mode of the redis client. Can be either <code class="docutils literal notranslate"><span class="pre">NONE</span></code> or <code class="docutils literal notranslate"><span class="pre">CLUSTER</span></code>.
(Default <code class="docutils literal notranslate"><span class="pre">NONE</span></code>)</p>
</div>
<div class="section" id="talk-redis-reconnection-backoff-factor">
<span id="talk-redis-reconnection-backoff-factor"></span><h2>TALK_REDIS_RECONNECTION_BACKOFF_FACTOR<a class="headerlink" href="#talk-redis-reconnection-backoff-factor" title="Permalink to this headline">¶</a></h2>
<p>The time factor that will be multiplied against the current attempt count
between attempts to connect to redis, parsed by
<a class="reference external" href="https://www.npmjs.com/package/ms">ms</a>. (Default <code class="docutils literal notranslate"><span class="pre">500</span> <span class="pre">ms</span></code>)</p>
</div>
<div class="section" id="talk-redis-reconnection-backoff-minimum-time">
<span id="talk-redis-reconnection-backoff-minimum-time"></span><h2>TALK_REDIS_RECONNECTION_BACKOFF_MINIMUM_TIME<a class="headerlink" href="#talk-redis-reconnection-backoff-minimum-time" title="Permalink to this headline">¶</a></h2>
<p>The minimum time used to delay before attempting to reconnect to redis, parsed
by <a class="reference external" href="https://www.npmjs.com/package/ms">ms</a>. (Default <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">sec</span></code>)</p>
</div>
<div class="section" id="talk-root-url-mount-path">
<span id="talk-root-url-mount-path"></span><h2>TALK_ROOT_URL_MOUNT_PATH<a class="headerlink" href="#talk-root-url-mount-path" title="Permalink to this headline">¶</a></h2>
<p>When set to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, the routes will be mounted onto the <code class="docutils literal notranslate"><span class="pre">&lt;PATHNAME&gt;</span></code> component
of the <a class="reference external" href="./02-01-required-configuration.html#talk-root-url">TALK_ROOT_URL</a>.
You would use this when your upstream proxy cannot strip the prefix from the
url. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
<p>If for example, you had the following configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TALK_ROOT_URL</span><span class="o">=</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">coralproject</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">talk</span><span class="o">/</span>
<span class="n">TALK_ROOT_URL_MOUNT_PATH</span><span class="o">=</span><span class="n">TRUE</span>
</pre></div>
</div>
<p>Then all the routes for the API will be expecting to be hit on <code class="docutils literal notranslate"><span class="pre">/talk/</span></code>, such as
<code class="docutils literal notranslate"><span class="pre">/talk/api/v1/graph/ql</span></code> instead of <code class="docutils literal notranslate"><span class="pre">/api/v1/graph/ql</span></code>. Most modern webservers
can perform the path stripping when serving an upstream proxy, but some CDN’s
cannot. You would use this option in the latter situation.</p>
</div>
<div class="section" id="talk-smtp-from-address">
<span id="talk-smtp-from-address"></span><h2>TALK_SMTP_FROM_ADDRESS<a class="headerlink" href="#talk-smtp-from-address" title="Permalink to this headline">¶</a></h2>
<p>The email address to send emails from using the SMTP provider in the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TALK_SMTP_FROM_ADDRESS</span><span class="o">=</span><span class="s2">&quot;The Coral Project&quot;</span> <span class="o">&lt;</span><span class="n">support</span><span class="nd">@coralproject</span><span class="o">.</span><span class="n">net</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Including the name and email address.</p>
</div>
<div class="section" id="talk-smtp-host">
<span id="talk-smtp-host"></span><h2>TALK_SMTP_HOST<a class="headerlink" href="#talk-smtp-host" title="Permalink to this headline">¶</a></h2>
<p>The domain for the SMTP provider that you are using.</p>
</div>
<div class="section" id="talk-smtp-password">
<span id="talk-smtp-password"></span><h2>TALK_SMTP_PASSWORD<a class="headerlink" href="#talk-smtp-password" title="Permalink to this headline">¶</a></h2>
<p>The password for the SMTP provider you are using.</p>
</div>
<div class="section" id="talk-smtp-port">
<span id="talk-smtp-port"></span><h2>TALK_SMTP_PORT<a class="headerlink" href="#talk-smtp-port" title="Permalink to this headline">¶</a></h2>
<p>The port for the SMTP provider that you are using.</p>
</div>
<div class="section" id="talk-smtp-username">
<span id="talk-smtp-username"></span><h2>TALK_SMTP_USERNAME<a class="headerlink" href="#talk-smtp-username" title="Permalink to this headline">¶</a></h2>
<p>The username of the SMTP provider you are using.</p>
</div>
<div class="section" id="talk-static-uri">
<span id="talk-static-uri"></span><h2>TALK_STATIC_URI<a class="headerlink" href="#talk-static-uri" title="Permalink to this headline">¶</a></h2>
<p>Used to set the uri where the static assets should be served from. This is used
when you want to upload the static assets through your build process to a
service like Google Cloud Storage or Amazon S3 and you would then specify the
CDN/Storage url. (Defaults to value of
<a class="reference external" href="./02-01-required-configuration.html#talk-root-url">TALK_ROOT_URL</a>)</p>
</div>
<div class="section" id="talk-threading-level">
<span id="talk-threading-level"></span><h2>TALK_THREADING_LEVEL<a class="headerlink" href="#talk-threading-level" title="Permalink to this headline">¶</a></h2>
<p>This is a <strong>Build Variable</strong> and must be consumed during build. If using the
<a class="reference external" href="./01-01-talk-quickstart.html#onbuild">Docker-onbuild</a>
image you can specify it with <code class="docutils literal notranslate"><span class="pre">--build-arg</span> <span class="pre">TALK_THREADING_LEVEL=3</span></code>.</p>
<p>Specify the maximum depth of the comment thread. (Default <code class="docutils literal notranslate"><span class="pre">3</span></code>)</p>
<p><strong>Note that a high value for <code class="docutils literal notranslate"><span class="pre">TALK_THREADING_LEVEL</span></code> will result in large
performance impacts.</strong></p>
</div>
<div class="section" id="talk-websocket-live-uri">
<span id="talk-websocket-live-uri"></span><h2>TALK_WEBSOCKET_LIVE_URI<a class="headerlink" href="#talk-websocket-live-uri" title="Permalink to this headline">¶</a></h2>
<p>Used to override the location to connect to the websocket endpoint to
potentially another host. This should be used when you need to route websocket
requests out of your CDN in order to serve traffic more efficiently.</p>
<p>If the value of <a class="reference external" href="./02-01-required-configuration.html#talk-root-url">TALK_ROOT_URL</a>
is a https url, then this defaults to <code class="docutils literal notranslate"><span class="pre">wss://${location.host}${MOUNT_PATH}api/v1/live</span></code>.
Otherwise, it defaults to <code class="docutils literal notranslate"><span class="pre">ws://${location.host}${MOUNT_PATH}api/v1/live</span></code>.</p>
<p>Where <code class="docutils literal notranslate"><span class="pre">MOUNT_PATH</span></code> is either <code class="docutils literal notranslate"><span class="pre">/</span></code> if <a class="reference external" href="#talk-root-url-mount-path">TALK_ROOT_URL_MOUNT_PATH</a>
is <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>, or the path component of
<a class="reference external" href="./02-01-required-configuration.html#talk-root-url">TALK_ROOT_URL</a> if it’s <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>.</p>
<p><strong>Warning: if used without managing the auth state manually, auth
cannot be persisted due to browser restrictions.</strong></p>
</div>
<div class="section" id="trust-thresholds">
<span id="trust-thresholds"></span><h2>TRUST_THRESHOLDS<a class="headerlink" href="#trust-thresholds" title="Permalink to this headline">¶</a></h2>
<p>Configure the reliability thresholds for flagging and commenting. (Default
<code class="docutils literal notranslate"><span class="pre">comment:2,-1;flag:2,-1</span></code>)</p>
<p>The form of the environment variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRUST_THRESHOLDS</span><span class="o">=</span><span class="n">comment</span><span class="p">:</span><span class="o">&lt;</span><span class="n">RELIABLE</span> <span class="n">COMMENTER</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">UNRELIABLE</span> <span class="n">COMMENTER</span><span class="o">&gt;</span><span class="p">;</span><span class="n">flag</span><span class="p">:</span><span class="o">&lt;</span><span class="n">RELIABLE</span> <span class="n">FLAGGER</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">UNRELIABLE</span> <span class="n">FLAGGER</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The default value of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRUST_THRESHOLDS</span><span class="o">=</span><span class="n">comment</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">flag</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>Could be read as:</p>
<ul class="simple">
<li>When a commenter has one comment rejected, their next comment must be
pre-moderated once in order to post freely again. If they instead get rejected
again, then they must have two of their comments approved in order to get
added back to the queue.</li>
<li>At the moment of writing, behavior is not attached to the flagging
reliability, but it is recorded.</li>
</ul>
</div>
<div class="section" id="talk-disable-ignore-flags-against-staff">
<span id="talk-disable-ignore-flags-against-staff"></span><h2>TALK_DISABLE_IGNORE_FLAGS_AGAINST_STAFF<a class="headerlink" href="#talk-disable-ignore-flags-against-staff" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, staff members will have their accounts and comments moderated the
same as any other user in the system. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
</div>
<div class="section" id="talk-email-subject-prefix">
<span id="talk-email-subject-prefix"></span><h2>TALK_EMAIL_SUBJECT_PREFIX<a class="headerlink" href="#talk-email-subject-prefix" title="Permalink to this headline">¶</a></h2>
<p>The prefix for the subject of emails sent. An email with the specified subject
of <code class="docutils literal notranslate"><span class="pre">Email</span> <span class="pre">Confirmation</span></code> would then be sent as <code class="docutils literal notranslate"><span class="pre">[Talk]</span> <span class="pre">Email</span> <span class="pre">Confirmation</span></code>.
(Default <code class="docutils literal notranslate"><span class="pre">[Talk]</span></code>)</p>
</div>
<div class="section" id="disable-create-mongo-indexes">
<span id="disable-create-mongo-indexes"></span><h2>DISABLE_CREATE_MONGO_INDEXES<a class="headerlink" href="#disable-create-mongo-indexes" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, Talk will not attempt to create any indices. This is recommended
for production systems that have ran Talk at least once during setup while unset
or set to <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>.</p>
</div>
<div class="section" id="talk-settings-cache-time">
<span id="talk-settings-cache-time"></span><h2>TALK_SETTINGS_CACHE_TIME<a class="headerlink" href="#talk-settings-cache-time" title="Permalink to this headline">¶</a></h2>
<p>The duration of time that the settings object will be kept in the Redis cache,
parsed by <a class="reference external" href="https://www.npmjs.com/package/ms">ms</a>. (Default
<code class="docutils literal notranslate"><span class="pre">1hr</span></code>)</p>
</div>
<div class="section" id="apollo-engine-key">
<span id="apollo-engine-key"></span><h2>APOLLO_ENGINE_KEY<a class="headerlink" href="#apollo-engine-key" title="Permalink to this headline">¶</a></h2>
<p>Used to set the key for use with
<a class="reference external" href="https://www.apollographql.com/engine/">Apollo Engine</a> for
tracing of GraphQL requests.</p>
<p><strong>Note: Apollo Engine is a premium service, charges may apply.</strong></p>
<p>[comment]: &lt;&gt; “TODO: re-add CSP once we’ve resolved issues with dynamic webpack loading.”</p>
<p>[comment]: &lt;&gt; “## TALK_ENABLE_STRICT_CSP”</p>
<p>[comment]: &lt;&gt; “Setting this to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> will enforce the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content Security Policy</a>”
[comment]: &lt;&gt; “(or CSP). By default, this configuration is set to [report only] (https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP#Testing_your_policy)”
[comment]: &lt;&gt; “where the policy is not enforced, but any violations are reported to a provided”
[comment]: &lt;&gt; “URI. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>) “</p>
</div>
<div class="section" id="allow-no-limit-queries">
<span id="allow-no-limit-queries"></span><h2>ALLOW_NO_LIMIT_QUERIES<a class="headerlink" href="#allow-no-limit-queries" title="Permalink to this headline">¶</a></h2>
<p>Setting this to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> will allow queries to execute without a limit (returns
all documents). This introduces a significant performance regression, and should
be used with caution. (Default <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)</p>
</div>
<div class="section" id="talk-addtl-comments-on-load-more">
<span id="talk-addtl-comments-on-load-more"></span><h2>TALK_ADDTL_COMMENTS_ON_LOAD_MORE<a class="headerlink" href="#talk-addtl-comments-on-load-more" title="Permalink to this headline">¶</a></h2>
<p>This is a <strong>Build Variable</strong> and must be consumed during build. If using the
<a class="reference external" href="./01-01-talk-quickstart.html#onbuild">Docker-onbuild</a>
image you can specify it with <code class="docutils literal notranslate"><span class="pre">--build-arg</span> <span class="pre">TALK_ADDTL_COMMENTS_ON_LOAD_MORE=10</span></code>.</p>
<p>Specifies the number of additional comments to load when a user clicks <code class="docutils literal notranslate"><span class="pre">Load</span> <span class="pre">More</span></code>. (Default <code class="docutils literal notranslate"><span class="pre">10</span></code>)</p>
</div>
<div class="section" id="talk-asset-comments-load-depth">
<span id="talk-asset-comments-load-depth"></span><h2>TALK_ASSET_COMMENTS_LOAD_DEPTH<a class="headerlink" href="#talk-asset-comments-load-depth" title="Permalink to this headline">¶</a></h2>
<p>This is a <strong>Build Variable</strong> and must be consumed during build. If using the
<a class="reference external" href="./01-01-talk-quickstart.html#onbuild">Docker-onbuild</a>
image you can specify it with <code class="docutils literal notranslate"><span class="pre">--build-arg</span> <span class="pre">TALK_ASSET_COMMENTS_LOAD_DEPTH=10</span></code>.</p>
<p>Specifies the initial number of comments to load for an asset. (Default <code class="docutils literal notranslate"><span class="pre">10</span></code>)</p>
</div>
<div class="section" id="talk-reply-comments-load-depth">
<span id="talk-reply-comments-load-depth"></span><h2>TALK_REPLY_COMMENTS_LOAD_DEPTH<a class="headerlink" href="#talk-reply-comments-load-depth" title="Permalink to this headline">¶</a></h2>
<p>This is a <strong>Build Variable</strong> and must be consumed during build. If using the
<a class="reference external" href="./01-01-talk-quickstart.html#onbuild">Docker-onbuild</a>
image you can specify it with <code class="docutils literal notranslate"><span class="pre">--build-arg</span> <span class="pre">TALK_REPLY_COMMENTS_LOAD_DEPTH=3</span></code>.</p>
<p>Specifies the initial replies to load for a comment. (Default <code class="docutils literal notranslate"><span class="pre">3</span></code>)</p>
</div>
<div class="section" id="talk-logging-level">
<span id="talk-logging-level"></span><h2>TALK_LOGGING_LEVEL<a class="headerlink" href="#talk-logging-level" title="Permalink to this headline">¶</a></h2>
<p>Sets the logging level for the context logger (from <a class="reference external" href="https://github.com/trentm/node-bunyan">Bunyan</a>) that will be phased in to replace most existing <code class="docutils literal notranslate"><span class="pre">debug()</span></code> calls. Supports the following values:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">fatal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">error</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">warn</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">info</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">debug</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">trace</span></code></li>
</ul>
</div>
<div class="section" id="talk-scraper-headers">
<span id="talk-scraper-headers"></span><h2>TALK_SCRAPER_HEADERS<a class="headerlink" href="#talk-scraper-headers" title="Permalink to this headline">¶</a></h2>
<p>A JSON string representing the configuration passed to the
<a class="reference external" href="https://www.npmjs.com/package/node-fetch">fetch</a> call for the scraper. It
can be used to set an authorization header, or change the user agent. (Default
<code class="docutils literal notranslate"><span class="pre">{}</span></code>)</p>
</div>
<div class="section" id="talk-scraper-proxy-url">
<span id="talk-scraper-proxy-url"></span><h2>TALK_SCRAPER_PROXY_URL<a class="headerlink" href="#talk-scraper-proxy-url" title="Permalink to this headline">¶</a></h2>
<p>Sets a specific HTTP/S proxy to be used by the Asset Scraper using <a class="reference external" href="https://www.npmjs.com/package/https-proxy-agent">https-proxy-agent</a>. Default is <code class="docutils literal notranslate"><span class="pre">null</span></code></p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Talk</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="01-01-talk-quickstart.html">Talk Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-04-planning-architecture.html">Planning your Talk Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-05-pre-launch-checklist.html">Pre-Launch Checklist</a></li>
</ul>
<p class="caption"><span class="caption-text">Configuration</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="02-01-required-configuration.html">Required Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced Configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">Integrating</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="integrating/asset-management.html">Asset Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrating/authentication.html">Authenticating with Talk</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrating/configuring-admin.html">Configuring the Talk Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrating/configuring-comment-stream.html">Configuring the Talk Comment Stream</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrating/event-tracking-metrics.html">Tracking Talk Events and Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrating/notifications.html">Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrating/styling-css.html">Styling Talk with CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrating/translations-i18n.html">Translations and i18n</a></li>
</ul>
<p class="caption"><span class="caption-text">Product Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="03-01-product-guide-how-talk-works.html">How Talk Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-02-product-guide-commenter-features.html">Commenter Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-03-product-guide-moderator-features.html">Moderator Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-04-user-roles.html">User Roles in Talk</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-05-product-guide-toxic-comments.html">Toxic Comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-06-product-guide-configuring-talk.html">Configuring Talk</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-07-product-guide-trust.html">Trust</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-08-gdpr.html">GDPR Compliance</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plugins/overview.html">Plugin Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins Directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-05-plugin-recipes.html">Plugin Recipes</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/overview.html">GraphQL API Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/graphql.html">GraphQL API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/server.html">Server Plugin API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/client.html">Client Plugin API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/slots.html">Plugin Slots API</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="05-01-building-basic-plugin.html">Creating a Basic Pride Reaction Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-02-customizing-plugins-coral-ui.html">Customizing Plugins with Coral UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-03-when-youve-installed-talk.html">What To Do When You’ve Installed Talk</a></li>
</ul>
<p class="caption"><span class="caption-text">Migrating</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="06-01-migrating-4-1.html">Migrating to v4.1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-01-migrating-4.html">Migrating to v4.0.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-03-migrating-from-3.html">Migrating from v3.x.x</a></li>
</ul>
<p class="caption"><span class="caption-text">FAQ &amp; Troubleshooting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="07-01-faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-02-troubleshooting-tips.html">Troubleshooting Tips</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="02-01-required-configuration.html" title="previous chapter">Required Configuration</a></li>
      <li>Next: <a href="integrating/asset-management.html" title="next chapter">Asset Management</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, CoralProject.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/02-02-advanced-configuration.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>